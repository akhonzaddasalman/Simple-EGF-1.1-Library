<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, maximum-scale=5" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="theme-color" content="#0b0f14" media="(prefers-color-scheme: dark)" />
  <meta name="theme-color" content="#f6f8fc" media="(prefers-color-scheme: light)" />
  <title>Simple EGF 1.1 Library</title>
  <link rel="stylesheet" href="./style.css" />
</head>

<body>
<header>
  <div class="left">
    <div class="brand">
      <span class="dot"></span>
      <span>Simple EGF 1.1 Library</span>
    </div>
  </div>

  <div class="row">
    <button id="btnOpenPkg" type="button" class="btn secondary game-controls" style="cursor:pointer; display:none">
      ğŸ“‚ Open an EGF package
    </button>

    <button class="btn secondary game-controls" id="btnPause" disabled title="Pause the game / Resume the game" style="display:none">â¸ Pause</button>
    <button class="btn secondary game-controls" id="btnScore" disabled title="View score" style="display:none">ğŸ† Score</button>
    <button class="btn secondary game-controls" id="btnAbout" title="View game info" style="display:none">â„¹ï¸ About the game</button>
    <button class="btn secondary" id="btnSettings" title="Open Settings">âš™ï¸ Settings</button>
  </div>
</header>

<input id="fileInput" type="file" accept=".egf" class="srOnly" />

<main>
  <!-- Bookshelf View (shown by default) -->
  <section class="bookshelf-view" id="bookshelfView">
    <div class="bookshelf-header">
      <h1 class="bookshelf-title" id="libraryTitle">ğŸ“š My Library</h1>
      <p class="bookshelf-subtitle" id="bookshelfSubtitle">Your EGF games will appear here</p>
    </div>

    <div class="bookshelf-actions">
      <button id="btnAddGame" type="button" class="btn">
        â• Add Game
      </button>
    </div>

    <div class="bookshelf-grid" id="bookshelfGrid">
      <!-- Games will be rendered here by JavaScript -->
    </div>
  </section>

  <!-- Game Player View (hidden by default) -->
  <section class="card game-player" id="gamePlayer" style="display:none">
    <div class="hd">
      <div class="player-nav">
        <button id="btnBackToLibrary" class="btn secondary" title="Back to library">â† Library</button>
      </div>
      <div class="sceneTitle" style="min-width:0">
        <div class="t" id="sceneName">No package loaded</div>
        <div class="s" id="sceneSub">Click "ğŸ“‚ Open an EGF package".</div>
      </div>

      <div class="progress" id="rolePill" style="display:none" title="Game progression">
        <span id="roleProgressText">0%</span>
        <span class="bar"><i id="roleBarFill"></i></span>
      </div>
    </div>

    <div class="sceneWrap" id="sceneWrap">
      <div class="pauseOverlay" id="pauseOverlay" aria-hidden="true">
        <div class="pausePanel">
          <h3>â¸ Game paused</h3>
          <p>Audio and video are paused, and interactions are disabled.</p>
          <div class="row" style="justify-content:center">
            <button class="btn good" id="btnResumeOverlay">â–¶ Resume</button>
          </div>
        </div>
      </div>

      <div class="content" id="sceneContent">
        <div class="textBlock muted">Load a .egf file to get started</div>
      </div>

      <div class="footerActions" id="sceneFooter"></div>
    </div>
  </section>
</main>

<div id="aboutModal" class="modal" aria-hidden="true">
  <div class="backdrop" id="aboutBackdrop"></div>
  <div class="panel" role="dialog" aria-modal="true" aria-label="About the game">
    <div class="panelHd">
      <div class="title">
        <span>â„¹ï¸ About the game</span>
      </div>
      <div class="row">
        <button class="btn secondary" id="btnCloseAbout" title="Close">âœ•</button>
      </div>
    </div>

    <div class="panelBd">
      <div class="notice" id="warnings" style="display:none"></div>

      <div class="aboutCoverWrap" id="aboutCoverWrap">
        <img id="aboutCover" class="aboutCoverImg" alt="EGF cover">
      </div>

      <div class="notice neutral">
        <div class="kv" style="margin-top:0">
          <div class="k">Game name</div><div class="v" id="kvTitle">â€”</div>
          <div class="k">Creator</div><div class="v" id="kvCreator">â€”</div>
          <div class="k">Description</div><div class="v" id="kvDesc">â€”</div>
          <div class="k">Creation / publication date</div><div class="v" id="kvDate">â€”</div>
          <div class="k">Last modified date</div><div class="v" id="kvModified">â€”</div>
          <div class="k">EGF Version</div><div class="v" id="kvVer">â€”</div>
        </div>
      </div>

    </div>
  </div>
</div>

<!-- Context menu for bookshelf items -->
<div id="bookContextMenu" class="context-menu" style="display:none">
  <button class="context-item" id="ctxPlay" data-i18n="play">â–¶ï¸ Play</button>
  <button class="context-item" id="ctxRemove" data-i18n="removeFromLibrary">ğŸ—‘ï¸ Remove from Library</button>
</div>

<div id="settingsModal" class="modal" aria-hidden="true">
  <div class="backdrop" id="settingsBackdrop"></div>
  <div class="panel" role="dialog" aria-modal="true" aria-label="Audio settings">
    <div class="panelHd">
      <div class="title">
        <span>âš™ï¸ Settings</span>
      </div>
      <div class="row">
        <button class="btn secondary" id="btnCloseSettings" title="Close">âœ•</button>
      </div>
    </div>

    <div class="panelBd">
      <div class="settingsGrid">

        <div class="settingsRow">
          <div class="left">
            <div class="name">Background volume</div>
            <div class="hint">Controls background sounds (background audio).</div>
          </div>
          <div class="right">
            <input id="bgVol" type="range" min="0" max="100" step="1" value="75" />
            <div class="pct" id="bgVolPct">75%</div>
            <label class="toggle" title="Mute/unmute background audio">
              <input id="bgMute" type="checkbox" />
              <span>Mute</span>
            </label>
          </div>
        </div>

        <div class="settingsRow">
          <div class="left">
            <div class="name">Foreground audio volume</div>
            <div class="hint">Controls foreground sounds (foreground audio).</div>
          </div>
          <div class="right">
            <input id="fgVol" type="range" min="0" max="100" step="1" value="100" />
            <div class="pct" id="fgVolPct">100%</div>
            <label class="toggle" title="Mute/unmute foreground audios">
              <input id="fgMute" type="checkbox" />
              <span>Mute</span>
            </label>
          </div>
        </div>
      </div>

      <div class="settingsRow">
        <div class="left">
          <div class="name">Theme</div>
          <div class="hint">Toggle between dark mode and light mode.</div>
        </div>
        
        <div class="right">
          <label class="toggle" title="Toggle dark/light mode">
            <input id="themeToggle" type="checkbox" />
            <span>Dark mode</span>
          </label>
        </div>
      </div>

      <div class="settingsRow">
        <div class="left">
          <div class="name" id="langLabel">Language</div>
          <div class="hint" id="langHint">Choose the interface language.</div>
        </div>

        <div class="right">
          <label class="toggle" title="Toggle language">
            <select id="langSelect" class="textInput" style="max-width:260px">
              <option value="en">English</option>
              <option value="fr">FranÃ§ais</option>
              <option value="es">EspaÃ±ol</option>
              <option value="pt">PortuguÃªs</option>
              <option value="zh">ä¸­æ–‡ï¼ˆæ™®é€šè¯ï¼‰</option>
              <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (Ø§Ù„ÙØµØ­Ù‰ Ø§Ù„Ø­Ø¯ÙŠØ«Ø©)</option>
              <option value="hi">à¤¹à¤¿à¤‚à¤¦à¥€</option>
              <option value="ur">Ø§Ø±Ø¯Ùˆ</option>
              <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
            </select>
          </label>
        </div>
      </div>

      <div class="settingsRow">
        <div class="left">
          <div class="name">Reset</div>
          <div class="hint">Reset the session (score, progress) and return to the title screen.</div>
        </div>
        <div class="right">
          <button class="btn secondary" id="btnReset" disabled title="Reset session">Reset</button>
        </div>
      </div>

    </div>
  </div>
</div>

<div id="scoreModal" class="modal" aria-hidden="true">
  <div class="backdrop" id="scoreBackdrop"></div>
  <div class="panel" role="dialog" aria-modal="true" aria-label="Score and debug">
    <div class="panelHd">
      <div class="title">
        <span>ğŸ† Score</span>
      </div>
      <div class="row">
        <button class="btn secondary" id="btnCloseScore" title="Close">âœ•</button>
      </div>
    </div>

    <div class="panelBd">
      <div class="notice neutral">
        <div class="kv" style="margin-top:0">
          <div class="k">Current scene</div><div class="v" id="kvCurrentScene">â€”</div>
          <div class="k">Current scene ID</div><div class="v" id="kvCurrentSceneId">â€”</div>
          <div class="k">Current scene role</div><div class="v" id="kvCurrentRole">â€”</div>
          <div class="k">Wrong answers count</div><div class="v" id="kvWrong">â€”</div>
          <div class="k">Game progression</div>
          <div class="v">
            <span id="scoreProgressPct" class="progressPct">0%</span>
          </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="./jszip.min.js"></script>
<script src="./i18n.js"></script>
<script src="./app.js"></script>

</body>
</html>